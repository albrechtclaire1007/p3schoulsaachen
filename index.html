<!DOCTYPE html>
<html lang="lb">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Schoulsaachen ‚Äì Drag & Drop</title>
  <style>
    @font-face{
      font-family:"Schoulschr√´ft Bold";
      src:url("https://github.com/albrechtclaire1007/schoulschreft/raw/refs/heads/main/schoulschreft_bold%5B2%5D.TTF") format("truetype");
      font-weight:bold;font-display:swap;
    }
    *{box-sizing:border-box;margin:0;padding:0}
    body{
      font-family:"Schoulschr√´ft Bold", Arial, sans-serif;
      background:linear-gradient(135deg,#cde4f5 0%,#8ab6d9 50%,#4f7ca0 100%);
      height:100vh; display:grid; place-items:center; overflow:hidden;
    }
    /* 16:9 stage */
    .stage{
      position:relative;
      width:min(100vw, calc(100vh * 16 / 9));
      height:min(100vh, calc(100vw * 9 / 16));
      background:#ffffffb3; border-radius:16px; padding:1.2rem;
      box-shadow:0 12px 30px rgba(0,0,0,.15);
      overflow:hidden;
    }
    .header{display:flex;gap:.8rem;justify-content:space-between;align-items:center;margin-bottom:.8rem}
    .title{font-size:clamp(20px,3vw,34px);color:#173c57}
    .controls{display:flex;gap:.6rem;align-items:center}
    .pill{background:#4f7ca0;color:#fff;padding:.4rem .9rem;border-radius:999px}
    .btn{background:#8ab6d9;color:#fff;border:none;padding:.5rem .9rem;border-radius:999px;cursor:pointer}
    .btn.secondary{background:#4f7ca0}

    .game{
      display:grid; grid-template-rows:auto 1fr; gap:.6rem; height:calc(100% - 3.2rem);
    }

    /* WORD BUTTONS */
    .word-cards{
      display:grid; grid-auto-flow:column; grid-auto-columns:max-content; gap:.4rem;
      overflow-x:auto; padding:.3rem;
    }
    .word-card{
      background:#fff; color:#173c57; border:2px solid #000;
      padding:.35rem .6rem; border-radius:14px; user-select:none; cursor:grab; font-size:clamp(12px,1.5vw,18px);
      transition:all .2s ease; display:inline-flex; align-items:center; gap:.4rem;
    }
    .word-card:hover{background:#8ab6d9; color:#fff; transform:translateY(-2px)}
    .word-card.dragging{opacity:.7; transform:rotate(3deg); cursor:grabbing}
    .word-card.correct-flash{background:#4f7ca0!important;color:#fff!important;animation:flash .8s ease}
    .play-icon{
      display:inline-grid; place-items:center; width:1.4em; height:1.4em; border-radius:999px;
      border:2px solid currentColor; font-size:0.9em; line-height:1; transform:translateY(1px);
      pointer-events:auto; cursor:pointer;
    }
    @keyframes flash{50%{transform:scale(1.07)}}

    /* BOARD */
    .board{
      position:relative; border-radius:12px; flex:1;
      box-shadow:inset 0 0 0 2px rgba(23,60,87,.12);
      background:#f8f9fa;
      display:grid; grid-template-columns:repeat(6, 1fr); grid-template-rows:repeat(3, 1fr);
      gap:1rem; padding:1rem;
    }
    /* simple inline ‚Äúclassroom‚Äù background */
    .board::before{
      content:""; position:absolute; inset:0; z-index:0;
      background:linear-gradient(180deg,#d7e8f6 0%, #a8c6df 100%);
      mask:
        radial-gradient(800px 200px at 50% 30%, rgba(0,0,0,.35) 99%, transparent 100%) top/100% 45% no-repeat,
        linear-gradient(#000 0 0) bottom/100% 60% no-repeat;
    }
    .drop-zone{
      position:relative; z-index:1;
      display:flex;flex-direction:column; align-items:center; justify-content:center;
      gap:.25rem; border-radius:12px; transition:.15s transform, .15s background;
      background:#fff; border:2px solid #e9ecef; padding:.5rem;
      min-height:120px; max-height:120px; overflow:hidden;
    }
    .drop-zone.drag-over{background:rgba(205,228,245,.5); transform:scale(1.05); border-color:#8ab6d9}
    .drop-zone.correct{background:rgba(79,124,160,.3); animation:flash .8s ease; border-color:#4f7ca0}
    .drop-zone img{max-width:80px; max-height:80px; object-fit:contain; border-radius:8px}
    .dropped-word{
      background:#4f7ca0; color:#fff; padding:.3rem .5rem; border-radius:8px;
      font-size:clamp(10px,1.2vw,14px); margin-top:.25rem; text-align:center;
    }

    .feedback{
      position:fixed; top:50%; left:50%; transform:translate(-50%,-50%);
      background:#fff; padding:1rem 2rem; border-radius:12px; box-shadow:0 8px 25px rgba(0,0,0,.3);
      font-size:clamp(18px,2.5vw,24px); z-index:1000; opacity:0; pointer-events:none; transition:.3s all;
    }
    .feedback.show{opacity:1; transform:translate(-50%,-50%) scale(1.05)}
    .feedback.correct{color:#4f7ca0; border:3px solid #4f7ca0}
    .feedback.incorrect{color:#dc3545; border:3px solid #dc3545}
  </style>
</head>
<body>
  <div class="stage">
    <div class="header">
      <h1 class="title">Schoulsaachen</h1>
      <div class="controls">
        <div class="pill">Score: <span id="score">0</span></div>
        <div class="pill" id="timer" style="display:none">Z√§it: <span id="time">60</span>s</div>
        <button class="btn" id="challengeBtn">60-Sekonnen</button>
        <button class="btn secondary" id="soundToggle" aria-pressed="true">üîä Sound: ON</button>
      </div>
    </div>

    <div class="game">
      <div class="word-cards" id="wordContainer"></div>

      <div class="board" id="board"></div>
    </div>

    <div class="feedback" id="feedback"></div>
  </div>

<script>
  /* ======= AUDIO CONFIG ======= */
  const AUDIO_BASE = "https://github.com/albrechtclaire1007/p3schoulsaachen/raw/refs/heads/main/";
  const AUDIO_FILES = {
    "d'Buch": "BUCH.mp3",
    "de Bl√§ist√´ft": "Bl√§ist√´ft.mp3",
    "de Classeur": "Classeuren.mp3",
    "de Gummi": "GUMMI.mp3",
    "d'Heft": "HEFT.mp3",
    "d'Kr√§id": "KR√ÑID.mp3",
    "d'L√©ierin": "l√©ierin.mp3",
    "de Lineal": "LINEAL.mp3",
    "d'Blat Pabeier": "PABEIER.mp3",
    "de Pech": "pech.mp3",
    "d'Schachtel": "SCHACHTEL.mp3",
    "de Schwamp": "Schamm.mp3",
    "d'Sch√©ier": "SCHEIER.mp3",
    "de Schoulsak": "Schoulsak.mp3",
    "de Sp√´tzer": "sp√´tzer.mp3",
    "d'Tafel": "tafel.mp3",
    "d'Tuschfaarf": "tuschfaarf.mp3",
    "d'Bl√§ist√´ftsfaarf": "blaischteftsfaarf.mp3"
  };
  let soundEnabled = true;
  function playWord(word) {
    if (!soundEnabled) return;
    const file = AUDIO_FILES[word];
    if (file) {
      const url = AUDIO_BASE + encodeURIComponent(file);
      new Audio(url).play().catch(()=>{});
      return;
    }
    // TTS fallback
    if ("speechSynthesis" in window) {
      const u = new SpeechSynthesisUtterance(word);
      const pick = (langs) => speechSynthesis.getVoices()
        .find(v => langs.some(l => v.lang && v.lang.toLowerCase().startsWith(l)));
      const v = pick(["lb","de-lu","de"]);
      if (v) u.voice = v;
      u.rate = 0.9;
      speechSynthesis.cancel();
      speechSynthesis.speak(u);
    }
  }

  /* ======= ITEMS (single source of truth) ======= */
  // id = matching key; label = card text & audio key; img = transparent image URL
  const ITEMS = [
    {id:'schoulsak',   label:"de Schoulsak",      img:"https://i.postimg.cc/bdTXYnWk/23.png"},
    {id:'buch',        label:"d'Buch",            img:"https://i.postimg.cc/nMpTLDYK/temp-Image5-PKPI3.avif"},
    {id:'heft',        label:"d'Heft",            img:"https://i.postimg.cc/F1QmHNR5/17.png"},
    {id:'classeur',    label:"de Classeur",       img:"https://i.postimg.cc/LnxMDPV2/20.png"},
    {id:'schachtel',   label:"d'Schachtel",       img:"https://i.postimg.cc/LJ8b80LM/8.png"},
    {id:'blaisteftsf', label:"d'Bl√§ist√´ftsfaarf", img:"https://i.postimg.cc/RJCYyM72/16.png"},
    {id:'tuschfaarf',  label:"d'Tuschfaarf",      img:"https://i.postimg.cc/bD9MmGtQ/15.png"},
    {id:'lineal',      label:"de Lineal",         img:"https://i.postimg.cc/14DTCFsb/14.png"},
    {id:'gummi',       label:"de Gummi",          img:"https://i.postimg.cc/t1xQ9MG4/21.png"},
    {id:'scheier',     label:"d'Sch√©ier",         img:"https://i.postimg.cc/HcXSNGDb/16.png"},
    {id:'pech',        label:"de Pech",           img:"https://i.postimg.cc/vcMKpmmT/7.png"},
    {id:'tafel',       label:"d'Tafel",           img:"https://i.postimg.cc/GTLjgWhg/temp-Image-Oxa-Tk-S.avif"},
    {id:'kraid',       label:"d'Kr√§id",           img:"https://i.postimg.cc/fVqgtjfS/15.png"},
    {id:'blat',        label:"d'Blat Pabeier",    img:"https://i.postimg.cc/dLBfvK7B/13.png"},
    {id:'schwamp',     label:"de Schwamp",        img:"https://i.postimg.cc/kBX024PZ/24.png"},
    {id:'blaisteft',   label:"de Bl√§ist√´ft",      img:"https://i.postimg.cc/tnGcRqtr/6.png"},
    {id:'spetzer',     label:"de Sp√´tzer",        img:"https://i.postimg.cc/njf8rGnY/22.png"},
    {id:'leierin',     label:"d'L√©ierin",         img:"https://i.postimg.cc/qh0cgPnB/temp-Imagevl-Joig.avif"}
  ];

  /* ======= STATE & HELPERS ======= */
  let score=0, challenge=false, secs=60, timer=null, dragged=null;

  const setScore = v => document.getElementById('score').textContent=v;
  function show(msg, ok){
    const f=document.getElementById('feedback');
    f.textContent=msg; f.className='feedback '+(ok?'correct':'incorrect')+' show';
    setTimeout(()=>f.classList.remove('show'), 900);
  }

  function buildUI(){
    const words = document.getElementById('wordContainer');
    const board = document.getElementById('board');

    // build word cards
    words.innerHTML = "";
    ITEMS.forEach(it=>{
      const card = document.createElement('div');
      card.className = 'word-card';
      card.draggable = true;
      card.dataset.id = it.id;
      card.dataset.word = it.label;
      card.innerHTML = `<span class="play-icon" title="Play">‚ñ∂</span> ${it.label}`;
      words.appendChild(card);
    });

    // build drop zones in a 6x3 grid
    board.innerHTML = "";
    ITEMS.forEach(it=>{
      const z = document.createElement('div');
      z.className='drop-zone';
      z.dataset.id = it.id; z.dataset.filled='0';
      const img = document.createElement('img');
      img.src = it.img; img.alt = it.label; img.onerror = ()=>{ img.style.display='none'; };
      z.appendChild(img);
      board.appendChild(z);
    });

    wireDnD();
    wireAudio();
  }

  function resetBoard(){
    document.querySelectorAll('.word-card').forEach(c=>{
      c.style.display='inline-flex'; c.classList.remove('correct-flash');
    });
    document.querySelectorAll('.drop-zone').forEach(z=>{
      z.classList.remove('correct'); z.dataset.filled='0';
      const dw=z.querySelector('.dropped-word'); if(dw) dw.remove();
    });
    score=0; setScore(score);
  }

  function startChallenge(){
    if(timer) clearInterval(timer);
    challenge=true; secs=60; resetBoard();
    document.getElementById('timer').style.display='inline-block';
    document.getElementById('time').textContent=secs;
    timer=setInterval(()=>{ secs--; document.getElementById('time').textContent=secs; if(secs<=0) endChallenge(); },1000);
    show('60-Sekonnen Challenge!', true);
  }
  function endChallenge(){
    challenge=false; if(timer) clearInterval(timer);
    document.getElementById('timer').style.display='none';
    show('F√§erdeg! Score: '+score, true);
  }

  function wireAudio(){
    const soundBtn = document.getElementById('soundToggle');
    soundBtn.addEventListener('click', ()=>{
      soundEnabled = !soundEnabled;
      soundBtn.textContent = soundEnabled ? "üîä Sound: ON" : "üîá Sound: OFF";
      soundBtn.setAttribute('aria-pressed', soundEnabled ? 'true' : 'false');
    });
    document.querySelectorAll('.word-card').forEach(card=>{
      const icon = card.querySelector('.play-icon');
      icon.addEventListener('click', (e)=>{ e.stopPropagation(); playWord(card.dataset.word); });
      card.addEventListener('click', ()=>{ if(!card.classList.contains('dragging')) playWord(card.dataset.word); });
    });
  }

  function wireDnD(){
    const cards = document.querySelectorAll('.word-card');
    const zones = document.querySelectorAll('.drop-zone');

    cards.forEach(c=>{
      c.addEventListener('dragstart',e=>{
        dragged=c; c.classList.add('dragging');
        e.dataTransfer.setData('text/plain', c.dataset.id);
        e.dataTransfer.effectAllowed='move';
      });
      c.addEventListener('dragend',()=>c.classList.remove('dragging'));
    });

    zones.forEach(z=>{
      z.addEventListener('dragover',e=>{ e.preventDefault(); z.classList.add('drag-over'); });
      z.addEventListener('dragleave',()=> z.classList.remove('drag-over'));
      z.addEventListener('drop',e=>{
        e.preventDefault(); z.classList.remove('drag-over');
        if(!dragged) return;
        if(z.dataset.filled==='1'){ show('D√´s Plaz ass schonn f√§erdeg.', false); dragged=null; return; }

        // ID-based matching (robust)
        if(dragged.dataset.id === z.dataset.id){
          score++; setScore(score);
          z.classList.add('correct'); z.dataset.filled='1';
          dragged.classList.add('correct-flash'); dragged.style.display='none';

          const dw=document.createElement('div');
          dw.className='dropped-word';
          dw.textContent = dragged.dataset.word;
          z.appendChild(dw);

          show('Richteg!', true);

          const total = document.querySelectorAll('.word-card').length;
          const hidden = document.querySelectorAll('.word-card[style*="display: none"]').length;
          if(hidden === total){
            setTimeout(()=> challenge ? endChallenge() : show('Alles richteg! Super!', true), 400);
          }
        } else {
          show('Prob√©ier nach eng K√©ier!', false);
        }
        dragged=null;
      });
    });
  }

  document.addEventListener('DOMContentLoaded',()=>{
    document.getElementById('challengeBtn').addEventListener('click', startChallenge);
    if ('speechSynthesis' in window) speechSynthesis.onvoiceschanged = ()=>{};
    buildUI();
  });
</script>
</body>
</html>

